<div class="page-header">
    <h1><i class="fas fa-history"></i> Edit History: <%= item.name %></h1>
    <div class="breadcrumb">
        <a href="/items/<%= item.id %>"><i class="fas fa-arrow-left"></i> Back to Item</a>
    </div>
</div>

<div class="history-container">
    <div class="current-info">
        <h3><i class="fas fa-info-circle"></i> Current Information</h3>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Name:</span>
                <span class="info-value"><%= item.name %></span>
            </div>
            <div class="info-item">
                <span class="info-label">Category:</span>
                <span class="info-value"><%= item.category_name %></span>
            </div>
            <div class="info-item">
                <span class="info-label">Price:</span>
                <span class="info-value">$<%= parseFloat(item.price).toFixed(2) %></span>
            </div>
            <div class="info-item">
                <span class="info-label">Stock:</span>
                <span class="info-value"><%= item.stock_quantity %> units</span>
            </div>
            <div class="info-item">
                <span class="info-label">Last Updated:</span>
                <span class="info-value"><%= new Date(item.updated_at).toLocaleString() %></span>
            </div>
            <div class="info-item">
                <span class="info-label">Created:</span>
                <span class="info-value"><%= new Date(item.created_at).toLocaleString() %></span>
            </div>
        </div>
    </div>

    <div class="history-actions">
        <a href="/items/<%= item.id %>/edit" class="btn btn-primary">
            <i class="fas fa-edit"></i> Edit Item
        </a>
    </div>

    <% if (changes && changes.length > 0) { %>
        <div class="changes-history">
            <h3><i class="fas fa-exchange-alt"></i> Recent Changes</h3>
            
            <div class="changes-list">
                <% changes.forEach(change => { %>
                    <div class="change-item">
                        <div class="change-header">
                            <span class="change-field"><%= change.field %></span>
                            <span class="change-date"><%= new Date(change.changed_at).toLocaleString() %></span>
                        </div>
                        <div class="change-details">
                            <span class="change-old">Old: <%= change.old_value %></span>
                            <i class="fas fa-arrow-right"></i>
                            <span class="change-new">New: <%= change.new_value %></span>
                        </div>
                        <% if (change.changed_by) { %>
                            <div class="change-by">
                                <i class="fas fa-user"></i> Changed by: <%= change.changed_by %>
                            </div>
                        <% } %>
                    </div>
                <% }); %>
            </div>
        </div>
    <% } else { %>
        <div class="no-changes">
            <i class="fas fa-clipboard-check fa-3x"></i>
            <h3>No Change History</h3>
            <p>This item hasn't been modified since it was created.</p>
        </div>
    <% } %>
</div>
